parameters:
  - name: artifactName
    type: string
    default: ''
  - name: gpuTarget
    type: string
    default: ''
  - name: destinationFolder
    type: string
    default: $(Agent.BuildDirectory)/rocm

steps:
  - task: DownloadPipelineArtifact@2
    displayName: 'Download Pipeline Build'
    inputs:
      itemPattern: '**/*${{ parameters.artifactName }}*${{ parameters.gpuTarget }}*'
      targetPath: $(System.ArtifactsDirectory)
  - task: ExtractFiles@1
    displayName: 'Extract Pipeline Build'
    inputs:
      archiveFilePatterns: '$(System.ArtifactsDirectory)/**/*.tar.gz'
      destinationFolder: ${{ parameters.destinationFolder }}
      cleanDestinationFolder: false
      overwriteExistingFiles: true
  - task: DeleteFiles@1
    displayName: 'Clean up Compressed Pipeline Build'
    inputs:
      SourceFolder: '$(System.ArtifactsDirectory)'
      Contents: '/**/*.tar.xz'
      RemoveDotFiles: true
